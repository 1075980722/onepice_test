"use strict";(self["webpackChunkonepic"]=self["webpackChunkonepic"]||[]).push([[4876],{94876:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"monitorsite"},[e("Asidetable",{ref:"asideTable"}),e("div",{staticClass:"legend"},["雨情监测"===t.showsitetable?e("p",[t._v("24h降雨图例")]):t._e(),"雨情监测"===t.showsitetable?e("div",{staticClass:"lebox"},t._l(t.legendrData,(function(a,i){return e("div",{key:i},[e("img",{attrs:{src:a.img,alt:""}}),e("div",{staticClass:"desc"},[e("span",[t._v(t._s(a.value))]),e("span",[t._v(t._s(a.desc))])])])})),0):t._e()]),e("Videodialog",{ref:"videodoalog",staticClass:"videodialog"}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.currTip,expression:"currTip"}],staticClass:"map-point-tip",style:t.currTipStyle},[t._v(" "+t._s(t.currTip)+" ")]),e("PopupDialog",{ref:"popupDialog",staticClass:"popupDialog",attrs:{header:t.header,columndata:t.columndata,chartData:t.chartData,query:t.query,isPopup:t.isPopup}})],1)},s=[],n=(a(57658),a(49950)),o=a(81413),l=a(76174),h=a(51206),c=a(12218),r={beforeRouteLeave(t,e,a){t.meta.keepAlive=!0,a()},components:{Asidetable:()=>a.e(6529).then(a.bind(a,16529)),PopupDialog:()=>a.e(9438).then(a.bind(a,9438)),Videodialog:()=>a.e(5880).then(a.bind(a,75880))},data(){return{showsitetable:this.$store.state.point.showasidetable,legendrData:[],currTip:"",currTipStyle:{},header:{},tableData:[],columndata:[],chartData:{},query:{},isPopup:""}},created(){this.$store.watch((t=>t.point.showasidetable),(()=>{this.showsitetable=this.$store.state.point.showasidetable}))},mounted(){this.handleGetYulIcon(),this.initBind()},methods:{async handleGetYulIcon(){this.legendrData=[];let t=await(0,n.Vc)(),e=t.result;e.forEach(((t,e)=>{this.legendrData.push({img:`./static/legend/rain/rain_list_${e}.png`,value:t.yuLiangTuLiVo.level,desc:t.yuLiangTuLiVo.rangeDescription})}))},initBind(){this.$store.state.map.view.on("pointer-down",(t=>{this.$store.state.map.view.hitTest(t).then((async t=>{const e=t.results;if(1==e.length&&"point"==e[0].graphic.geometry.type)if("rainfullLayer"===e[0].layer.id){const{attributes:t}=e[0].graphic;setTimeout((()=>{this.$refs.popupDialog.$children[0].dialogTableVisible=!0}),500);const{name:a,longitude:i,latitude:s,stcd:o,source:l}=t;this.header={name:a},this.$store.state.map.view.goTo({center:new c.Z({x:i,y:s}),scale:3e4}).then((()=>{console.log("平移")}));const h=this.formatDateTime(new Date(new Date((new Date).getTime()-864e5))),r=this.formatDateTime(new Date((new Date).getTime()));this.query={},this.query.code=o,this.query.source=l;let u={startTime:h,endTime:r,code:o,source:l},d=await(0,n.sq)(u),m=d.result[0];this.columndata=[],this.chartData={},this.$store.state.point.tableData=[],this.chartData.xData=[],this.chartData.yData1=[],this.chartData.yData2=[],m.yuLiangAccumulateVos.forEach(((t,e)=>{let a={};a.id=e+1,a.collectTime=null==t.tm?"-":t.tm.slice(5,-3),a.shiDuanYuLiang=null==t.hsum?"-":t.hsum,this.chartData.totalNum=null==t.cum?"-":t.cum,this.chartData.xData.push(t.tm.slice(5,-3)),this.chartData.yData1.push(t.hsum),this.chartData.yData2.push(t.cum),this.$store.dispatch("updateTableData",a)}));let p=[];p.push({name:a},{stcd:o},{longitude:i},{latitude:s}),p.forEach((t=>{let e={},a=Object.values(t).join();switch(Object.keys(t).join()){case"name":e.key="站名";break;case"stcd":e.key="编码";break;case"longitude":e.key="经度";break;case"latitude":e.key="纬度";break}e.value=""===a?"—":a,this.columndata.push(e)}))}else if("evaorationLayer"===e[0].layer.id){const{attributes:t}=e[0].graphic;setTimeout((()=>{this.$refs.popupDialog.$children[0].dialogTableVisible=!0}),500);const{name:a,longitude:i,latitude:s,stcd:n,source:l}=t;this.header={name:a},this.$store.state.map.view.goTo({center:new c.Z({x:i,y:s}),scale:3e4}).then((()=>{console.log("平移")}));const h=this.formatDateTime(new Date(new Date((new Date).getTime()-2592e5))),r=this.formatDateTime(new Date((new Date).getTime()));this.query={},this.query.code=n,this.query.source=l;let u={startTime:h,endTime:r,code:n,source:l},d=await(0,o.t)(u),m=d.result[0];this.columndata=[],this.chartData={},this.$store.state.point.tableData=[],this.chartData.xData=[],this.chartData.yData1=[],this.chartData.yData2=[],m.zhengFaAccumulateVos.forEach(((t,e)=>{let a={};a.id=e+1,a.collectTime=null==t.tm?"-":t.tm.slice(5,-3),a.zhengfl=null==t.wsfe?"-":t.wsfe,this.chartData.totalNum=null==t.cum?"-":t.cum,this.chartData.xData.push(t.tm.slice(5,-3)),this.chartData.yData1.push(t.wsfe),this.chartData.yData2.push(t.cum),this.$store.dispatch("updateTableData",a)}));let p=[];p.push({name:a},{stcd:n},{longitude:i},{latitude:s}),p.forEach((t=>{let e={},a=Object.values(t).join();switch(Object.keys(t).join()){case"name":e.key="站名";break;case"stcd":e.key="编码";break;case"longitude":e.key="经度";break;case"latitude":e.key="纬度";break}e.value=""===a?"—":a,this.columndata.push(e)}))}else if("waterinfoLayer"===e[0].layer.id){console.log("00000"),this.isPopup="0";const{attributes:t}=e[0].graphic;setTimeout((()=>{this.$refs.popupDialog.$children[0].dialogTableVisible=!0}),500);const{name:a,longitude:i,latitude:s,code:n,type:o}=t;this.header={name:a},this.$store.state.map.view.goTo({center:new c.Z({x:i,y:s}),scale:3e4}).then((()=>{console.log("平移")}));const h=this.formatDateTime(new Date(new Date((new Date).getTime()-864e5))),r=this.formatDateTime(new Date((new Date).getTime()));this.query={code:n,type:o};let u={startTime:h,endTime:r,code:n,type:o},d=await(0,l._2)(u),m=d.result;this.columndata=[],this.chartData={},this.$store.state.point.tableData=[],this.chartData={xData:[],yData1:[]};let p=[];p.push({name:a},{code:n},{longitude:i},{latitude:s}),p.forEach((t=>{let e={},a=Object.values(t).join();switch(Object.keys(t).join()){case"name":e.key="站名";break;case"code":e.key="编码";break;case"longitude":e.key="经度";break;case"latitude":e.key="纬度";break}e.value=""===a?"—":a,this.columndata.push(e)}));let D=[];if(null!=m.shuiQingHisInfoVo.shuiQingDataVoList){let t=m.shuiQingHisInfoVo.shuiQingDataVoList.filter((t=>"00"===t.collectTime.slice(-5,-3)));t.forEach(((t,e)=>{let a={};a.id=e+1,a.collectTime=null==t.collectTime?"-":t.collectTime.slice(5,-3),a.shuiWei=null==t.shuiWei?"-":t.shuiWei,this.chartData.xData.push(t.collectTime.slice(5,-3)),this.chartData.yData1.push(t.shuiWei),D.push(a),this.$store.dispatch("updateTableData",a)}))}}else if("waterinfoBindLayer"===e[0].layer.id){this.isPopup="1";const{attributes:t}=e[0].graphic;setTimeout((()=>{this.$refs.popupDialog.$children[0].dialogTableVisible=!0}),500);const{name:a,longitude:i,latitude:s,code:n,type:o}=t;this.header={name:a},this.$store.state.map.view.goTo({center:new c.Z({x:i,y:s}),scale:3e4}).then((()=>{console.log("平移")}));const h=this.formatDateTime(new Date(new Date((new Date).getTime()-864e5))),r=this.formatDateTime(new Date((new Date).getTime()));this.query={code:n,type:o};let u={startTime:h,endTime:r,code:n,type:o},d=await(0,l._2)(u),m=d.result;this.columndata=[],this.chartData={},this.$store.state.point.tableData=[],this.chartData={xData:[],yData1:[],yData2:[],yData3:[]};let p=[];p.push({name:a},{code:n},{longitude:i},{latitude:s}),p.forEach((t=>{let e={},a=Object.values(t).join();switch(Object.keys(t).join()){case"name":e.key="站名";break;case"code":e.key="编码";break;case"longitude":e.key="经度";break;case"latitude":e.key="纬度";break}e.value=""===a?"—":a,this.columndata.push(e)}));let D=[];if(null!=m.shuiQingHisInfoVo.shuiQingDataVoList){let t=m.shuiQingHisInfoVo.shuiQingDataVoList.filter((t=>"00"===t.collectTime.slice(-5,-3)));t.forEach(((t,e)=>{let a={};a.id=e+1,a.collectTime=null==t.collectTime?"-":t.collectTime.slice(5,-3),a.shuiWei=null==t.shuiWei?"-":t.shuiWei,this.chartData.xData.push(t.collectTime.slice(5,-3)),this.chartData.yData1.push(t.shuiWei),D.push(a)}))}let g=[];null!=m.yuLiangInfoVo.yuLiangAccumulateVos&&m.yuLiangInfoVo.yuLiangAccumulateVos.forEach((t=>{let e={};e.yul=null==t.hsum?"—":t.hsum,g.push(e),this.chartData.yData2.push(t.cum),this.chartData.yData3.push(t.hsum)}));let y=[];D.forEach((t=>{y.push(Object.assign(t,g[t.id-1]))})),y.forEach((t=>{this.$store.dispatch("updateTableData",t)}))}else if("waterinfoGPLayer"===e[0].layer.id){this.isPopup="2";const{attributes:t}=e[0].graphic;setTimeout((()=>{this.$refs.popupDialog.$children[0].dialogTableVisible=!0}),500);const{name:a,longitude:i,latitude:s,code:n,id:o,type:h}=t;this.header={name:a},this.$store.state.map.view.goTo({center:new c.Z({x:i,y:s}),scale:3e4}).then((()=>{console.log("平移")}));const r=this.formatDateTime(new Date(new Date((new Date).getTime()-864e5))),u=this.formatDateTime(new Date((new Date).getTime()));this.query={code:n,type:h};let d={startTime:r,endTime:u,code:n,type:h},m=await(0,l._2)(d),p=m.result;this.columndata=[],this.chartData={},this.$store.state.point.tableData=[],this.chartData={xData:[],yData1:[],yData2:[]};let D=[];D.push({name:a},{id:o},{longitude:i},{latitude:s}),D.forEach((t=>{let e={},a=Object.values(t).join();switch(Object.keys(t).join()){case"name":e.key="站名";break;case"id":e.key="编码";break;case"longitude":e.key="经度";break;case"latitude":e.key="纬度";break}e.value=""===a?"—":a,this.columndata.push(e)}));let g=[];if(null!=p.shuiQingHisInfoVo.shuiQingDataVoList){let t=p.shuiQingHisInfoVo.shuiQingDataVoList.filter((t=>"00"===t.collectTime.slice(-5,-3)));t.forEach(((t,e)=>{let a={};a.id=e+1,a.collectTime=null==t.collectTime?"-":t.collectTime.slice(5,-3),a.shangShuiWei=null==t.shangShuiWei?"-":t.shangShuiWei,a.xiaShuiWei=null==t.xiaShuiWei?"-":t.xiaShuiWei,this.chartData.xData.push(t.collectTime.slice(5,-3)),this.chartData.yData1.push(t.shangShuiWei),this.chartData.yData2.push(t.xiaShuiWei),g.push(a),this.$store.dispatch("updateTableData",a)}))}}else if("waterqualityLayer"===e[0].layer.id){const{attributes:t}=e[0].graphic;setTimeout((()=>{this.$refs.popupDialog.$children[0].dialogTableVisible=!0}),500);const{name:a,longitude:i,latitude:s,htCode:n,source:o}=t;this.header={name:a},this.$store.state.map.view.goTo({center:new c.Z({x:i,y:s}),scale:3e4}).then((()=>{console.log("平移")}));const l=this.formatDateTime(new Date(new Date((new Date).getTime()-864e5))),r=this.formatDateTime(new Date((new Date).getTime()));this.query={},this.query.code=n,this.query.source=o;let u={startTime:l,endTime:r,code:n,source:o},d=await(0,h.H)(u),m=d.result[0];this.columndata=[],this.chartData={},this.$store.state.point.tableData=[],this.chartData={xData:[],yData1:[],yData2:[],yData3:[],yData4:[],yData5:[]},m.shuiZhiHistoryInfoVos.forEach(((t,e)=>{let a={};a.id=e+1,a.collectTime=null==t.spt?"-":t.spt.slice(5,-3),a.nh3n=null==t.nh3n?"-":t.nh3n,a.tp=null==t.tp?"-":t.tp,a.codmn=null==t.codmn?"-":t.codmn,a.dox=null==t.dox?"-":t.dox,a.codcr=null==t.codcr?"-":t.codcr,this.chartData.xData.push(t.spt.slice(5,-3)),this.chartData.yData1.push(t.nh3n),this.chartData.yData2.push(t.tp),this.chartData.yData3.push(t.codmn),this.chartData.yData4.push(t.dox),this.chartData.yData5.push(t.codcr),this.$store.dispatch("updateTableData",a)}));let p=[];p.push({name:a},{htCode:n},{longitude:i},{latitude:s}),p.forEach((t=>{let e={},a=Object.values(t).join();switch(Object.keys(t).join()){case"name":e.key="站名";break;case"htCode":e.key="编码";break;case"longitude":e.key="经度";break;case"latitude":e.key="纬度";break}e.value=""===a?"—":a,this.columndata.push(e)}))}}))})),this.$store.state.map.view.on("pointer-move",(t=>{const{x:e,y:a}=t;this.$store.state.map.view.hitTest(t).then((t=>{const i=t.results;if(i.length&&i[0].graphic){const{sourceLayer:t,attributes:s}=i[0].graphic;if(!t||!s)return;const{name:n,location:o,positionDescription:l}=s;t&&["rainfullLayer","evaorationLayer","waterinfoLayer","waterinfoBindLayer","waterinfoGPLayer","engineeringinfoLayer","waterqualityLayer"].includes(t.id)?(n?this.currTip=`${n}`:o?this.currTip=`${o}`:l&&(this.currTip=`${l}`),this.currTipStyle={top:a+-25+"px",left:e+15+"px"}):this.currTip=""}else this.currTip=""}))}))}}},u=r,d=a(1001),m=(0,d.Z)(u,i,s,!1,null,"c6baf38c",null),p=m.exports},81413:function(t,e,a){a.d(e,{t:function(){return n},x:function(){return s}});var i=a(16391);const s=t=>(0,i.Z)({url:"/mainBizZhengFa/open/getRealTimeDataAllZhengFa",method:"GET",params:t}),n=t=>(0,i.Z)({url:"/mainBizZhengFa/open/getHistoryDataOneZhengFa",method:"GET",params:t})},49950:function(t,e,a){a.d(e,{T9:function(){return n},Vc:function(){return s},sq:function(){return o}});var i=a(16391);const s=t=>(0,i.Z)({url:"/mainBizYuLiang/open/getYuLiangTuLi",method:"GET",params:t}),n=t=>(0,i.Z)({url:"/mainBizYuLiang/open/getRealTimeDataAllYuLiangV2",method:"GET",params:t}),o=t=>(0,i.Z)({url:"/mainBizYuLiang/open/getHistoryDataOneYuLiangV2",method:"GET",params:t})},76174:function(t,e,a){a.d(e,{DJ:function(){return n},E3:function(){return s},_2:function(){return o}});var i=a(16391);const s=t=>(0,i.Z)({url:"/mainBizShuiQing/open/getList",method:"GET",params:t}),n=t=>(0,i.Z)({url:"/mainBizShuiQing/open/getRealTimeDataAllShuiWeiV2",method:"GET",params:t}),o=t=>(0,i.Z)({url:"/mainBizShuiQing/open/getOneShuiQingHistoryDataV2",method:"GET",params:t})},51206:function(t,e,a){a.d(e,{E:function(){return s},H:function(){return n}});var i=a(16391);const s=t=>(0,i.Z)({url:"/mainBizShuiZhi/open/getRealTimeDataAllShuiZhiV2",method:"GET",params:t}),n=t=>(0,i.Z)({url:"/mainBizShuiZhi/open/getHistoryDataOneShuiZhiV2",method:"GET",params:t})}}]);