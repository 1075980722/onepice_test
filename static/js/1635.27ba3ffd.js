"use strict";(self["webpackChunkonepic"]=self["webpackChunkonepic"]||[]).push([[1635,4303],{44303:function(e,t,n){var r;n.d(t,{Hy:function(){return d},OF:function(){return u},TD:function(){return f},Tu:function(){return m},VO:function(){return h},aV:function(){return a},kq:function(){return l},rH:function(){return r}}),function(e){e.AsyncNotEnabled="AsyncNotEnabled",e.ModulesNotSupported="ModulesNotSupported",e.CircularModules="CircularModules",e.NeverReach="NeverReach",e.UnsupportedHashType="UnsupportedHashType",e.InvalidParameter="InvalidParameter",e.UnexpectedToken="UnexpectedToken",e.Unrecognised="Unrecognised",e.UnrecognisedType="UnrecognisedType",e.MaximumCallDepth="MaximumCallDepth",e.BooleanConditionRequired="BooleanConditionRequired",e.TypeNotAllowedInFeature="TypeNotAllowedInFeature",e.KeyMustBeString="KeyMustBeString",e.WrongNumberOfParameters="WrongNumberOfParameters",e.CallNonFunction="CallNonFunction",e.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral",e.NoFunctionInDictionary="NoFunctionInDictionary",e.NoFunctionInArray="NoFunctionInArray",e.AssignModuleFunction="AssignModuleFunction",e.LogicExpressionOrAnd="LogicExpressionOrAnd",e.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean",e.FuncionNotFound="FunctionNotFound",e.InvalidMemberAccessKey="InvalidMemberAccessKey",e.UnsupportedUnaryOperator="UnsupportUnaryOperator",e.InvalidIdentifier="InvalidIdentifier",e.MemberOfNull="MemberOfNull",e.UnsupportedOperator="UnsupportedOperator",e.Cancelled="Cancelled",e.ModuleAccessorMustBeString="ModuleAccessorMustBeString",e.ModuleExportNotFound="ModuleExportNotFound",e.Immutable="Immutable",e.OutOfBounds="OutOfBounds",e.IllegalResult="IllegalResult",e.FieldNotFound="FieldNotFound",e.PortalRequired="PortalRequired",e.LogicError="LogicError",e.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber",e.KeyAccessorMustBeString="KeyAccessorMustBeString",e.WrongSpatialReference="WrongSpatialReference"}(r||(r={}));const o={[r.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[r.LogicError]:"Logic error - {reason}",[r.NeverReach]:"Encountered unreachable logic",[r.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[r.ModuleAccessorMustBeString]:"Module accessor must be a string",[r.ModuleExportNotFound]:"Module has no export with provided identifier",[r.ModulesNotSupported]:"Current profile does not support modules",[r.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[r.FuncionNotFound]:"Function not found",[r.FieldNotFound]:"Key not found - {key}",[r.CircularModules]:"Circular module dependencies are not allowed",[r.Cancelled]:"Execution cancelled",[r.UnsupportedHashType]:"Type not supported in hash function",[r.IllegalResult]:"Value is not a supported return type",[r.PortalRequired]:"Portal is required",[r.InvalidParameter]:"Invalid parameter",[r.WrongNumberOfParameters]:"Call with wrong number of parameters",[r.Unrecognised]:"Unrecognised code structure",[r.UnrecognisedType]:"Unrecognised type",[r.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[r.BooleanConditionRequired]:"Conditions must use booleans",[r.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[r.NoFunctionInArray]:"Arrays cannot contain functions.",[r.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[r.KeyAccessorMustBeString]:"Accessor must be a string",[r.KeyMustBeString]:"Object keys must be a string",[r.Immutable]:"Object is immutable",[r.InvalidParameter]:"Invalid parameter",[r.UnexpectedToken]:"Unexpected token",[r.MemberOfNull]:"Cannot access property of null object",[r.MaximumCallDepth]:"Exceeded maximum function depth",[r.OutOfBounds]:"Out of bounds",[r.InvalidIdentifier]:"Identifier not recognised",[r.FuncionNotFound]:"Function not found",[r.CallNonFunction]:"Expression is not a function",[r.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[r.AssignModuleFunction]:"Cannot assign function to module variable",[r.UnsupportedUnaryOperator]:"Unsupported unary operator",[r.UnsupportedOperator]:"Unsupported operator",[r.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[r.LogicExpressionOrAnd]:"Logical expression can only be combined with || or &&"};class i extends Error{constructor(...e){super(...e)}}class s extends i{constructor(e,t){super(c(t)+e.message,{cause:e}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,s),t&&t.loc&&(this.loc=t.loc)}}class a extends Error{constructor(e,t,n,r){super("Execution error - "+c(n)+d(o[t],r)),this.loc=null,this.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,a),n&&n.loc&&(this.loc=n.loc)}}function c(e){return e&&e.loc?`Line : ${e.loc.start?.line}, ${e.loc.start?.column}: `:""}class u extends Error{constructor(e,t,n,r){super("Compilation error - "+c(n)+d(o[t],r)),this.loc=null,this.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,u),n&&n.loc&&(this.loc=n.loc)}}class l extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,l)}}function d(e,t){try{if(!t)return e;for(const n in t){let r=t[n];r||(r=""),e=e.replace("{"+n+"}",t[n])}}catch(i){}return e}function h(e,t,n){return"esri.arcade.arcadeexecutionerror"===n.declaredRootClass||"esri.arcade.arcadecompilationerror"===n.declaredRootClass?null===n.loc&&t&&t.loc?new s(n,{cause:n}):n:("esri.arcade.featureset.support.featureseterror"===n.declaredRootClass||"esri.arcade.featureset.support.sqlerror"===n.declaredRootClass||n.declaredRootClass,t&&t.loc?new s(n,{cause:n}):n)}var f;!function(e){e.UnrecognisedUri="UnrecognisedUri",e.UnsupportedUriProtocol="UnsupportedUriProtocol"}(f||(f={}));const p={[f.UnrecognisedUri]:"Unrecognised uri - {uri}",[f.UnsupportedUriProtocol]:"Unrecognised uri protocol"};class m extends Error{constructor(e,t){super(d(p[e],t)),this.declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,m)}}},26114:function(e,t,n){n.d(t,{a:function(){return s},c:function(){return r},f:function(){return i}});n(23767),n(8585),n(68696);function r(){return[1,0,0,0,1,0,0,0,1]}function o(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]}function i(e,t,n,r,o,i,s,a,c){return[e,t,n,r,o,i,s,a,c]}function s(e,t){return new Float64Array(e,t,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:o,create:r,createView:s,fromValues:i},Symbol.toStringTag,{value:"Module"}))},45263:function(e,t,n){n.d(t,{I:function(){return a},a:function(){return r},b:function(){return o},c:function(){return s}});n(23767),n(8585),n(68696);function r(){return[0,0,0,1]}function o(e){return[e[0],e[1],e[2],e[3]]}function i(e,t,n,r){return[e,t,n,r]}function s(e,t){return new Float64Array(e,t,4)}const a=r();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:a,clone:o,create:r,createView:s,fromValues:i},Symbol.toStringTag,{value:"Module"}))},5312:function(e,t,n){n.d(t,{N:function(){return r}});const r={convertToGEGeometry:o,exportPoint:s,exportPolygon:c,exportPolyline:l,exportMultipoint:h,exportExtent:p};function o(e,t){return null==t?null:e.convertJSONToGeometry(t)}class i{constructor(e,t,n){this.x=e,this.y=t,this.spatialReference=n,this.z=void 0,this.m=void 0}}function s(e,t,n){const r=new i(e.getPointX(t),e.getPointY(t),n),o=e.hasZ(t),s=e.hasM(t);return o&&(r.z=e.getPointZ(t)),s&&(r.m=e.getPointM(t)),r}class a{constructor(e,t,n,r){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}function c(e,t,n){return new a(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))}class u{constructor(e,t,n,r){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}function l(e,t,n){return new u(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))}class d{constructor(e,t,n,r){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}function h(e,t,n){return new d(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))}class f{constructor(e,t,n,r,o){this.xmin=e,this.ymin=t,this.xmax=n,this.ymax=r,this.spatialReference=o,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}function p(e,t,n){const r=e.hasZ(t),o=e.hasM(t),i=new f(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(r){const n=e.getZExtent(t);i.zmin=n.vmin,i.zmax=n.vmax}if(o){const n=e.getMExtent(t);i.mmin=n.vmin,i.mmax=n.vmax}return i}},16160:function(e,t,n){n.d(t,{Ue:function(){return c},nF:function(){return l},zk:function(){return u}});var r=n(67752),o=n(97257),i=n(65554),s=n(74674),a=n(62069);function c(e){return e?{origin:(0,s.a)(e.origin),vector:(0,s.a)(e.vector)}:{origin:(0,s.c)(),vector:(0,s.c)()}}function u(e,t,n=c()){return(0,i.c)(n.origin,e),(0,i.b)(n.vector,t,e),n}function l(e,t,n){return d(e,t,0,1,n)}function d(e,t,n,o,s){const{vector:c,origin:u}=e,l=(0,i.b)(a.WM.get(),t,u),d=(0,i.e)(c,l)/(0,i.p)(c);return(0,i.g)(s,c,(0,r.uZ)(d,n,o)),(0,i.a)(s,s,e.origin)}(0,s.c)(),(0,s.c)(),new o.x((()=>c()))},857:function(e,t,n){n.d(t,{G6:function(){return I},Ie:function(){return v},J9:function(){return F},RF:function(){return R},U1:function(){return S},vY:function(){return c},ym:function(){return A}});n(57658);var r=n(8693),o=n(90421);const i=(e,t,n)=>[t,n],s=(e,t,n)=>[t,n,e[2]],a=(e,t,n)=>[t,n,e[2],e[3]];function c(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,r.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function u({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function l({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function d(e,t,n){const r=[];let o,i,s,a;for(let c=0;c<n.length;c++){const d=n[c];c>0?(s=u(e,d[0]),a=l(e,d[1]),s===o&&a===i||(r.push(t(d,s-o,a-i)),o=s,i=a)):(o=u(e,d[0]),i=l(e,d[1]),r.push(t(d,o,i)))}return r.length>0?r:null}function h(e,t,n,r){return d(e,n?r?a:s:r?s:i,t)}function f(e,t,n,r){const o=[],c=n?r?a:s:r?s:i;for(let i=0;i<t.length;i++){const n=d(e,c,t[i]);n&&n.length>=3&&o.push(n)}return o.length?o:null}function p(e,t,n,r){const o=[],c=n?r?a:s:r?s:i;for(let i=0;i<t.length;i++){const n=d(e,c,t[i]);n&&n.length>=2&&o.push(n)}return o.length?o:null}function m({scale:e,translate:t},n){return n*e[0]+t[0]}function _({scale:e,translate:t},n){return t[1]-n*e[1]}function g(e,t,n){const r=new Array(n.length);if(!n.length)return r;const[o,i]=e.scale;let s=m(e,n[0][0]),a=_(e,n[0][1]);r[0]=t(n[0],s,a);for(let c=1;c<n.length;c++){const e=n[c];s+=e[0]*o,a-=e[1]*i,r[c]=t(e,s,a)}return r}function T(e,t,n){const r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=g(e,t,n[o]);return r}function b(e,t,n,r){return g(e,n?r?a:s:r?s:i,t)}function x(e,t,n,r){return T(e,n?r?a:s:r?s:i,t)}function O(e,t,n,r){return T(e,n?r?a:s:r?s:i,t)}function E(e,t,n,r,o){return t.xmin=u(e,n.xmin),t.ymin=l(e,n.ymin),t.xmax=u(e,n.xmax),t.ymax=l(e,n.ymax),t!==n&&(r&&(t.zmin=n.zmin,t.zmax=n.zmax),o&&(t.mmin=n.mmin,t.mmax=n.mmax)),t}function M(e,t,n,r,o){return t.points=h(e,n.points,r,o)??[],t}function R(e,t,n,r,o){return t.x=u(e,n.x),t.y=l(e,n.y),t!==n&&(r&&(t.z=n.z),o&&(t.m=n.m)),t}function y(e,t,n,r,o){const i=f(e,n.rings,r,o);return i?(t.rings=i,t):null}function N(e,t,n,r,o){const i=p(e,n.paths,r,o);return i?(t.paths=i,t):null}function A(e,t){return e&&t?(0,o.wp)(t)?R(e,{},t,!1,!1):(0,o.l9)(t)?N(e,{},t,!1,!1):(0,o.oU)(t)?y(e,{},t,!1,!1):(0,o.aW)(t)?M(e,{},t,!1,!1):(0,o.YX)(t)?E(e,{},t,!1,!1):null:null}function F(e,t,n,o,i){return(0,r.pC)(n)&&(t.points=b(e,n.points,o,i)),t}function S(e,t,n,o,i){return(0,r.Wi)(n)||(t.x=m(e,n.x),t.y=_(e,n.y),t!==n&&(o&&(t.z=n.z),i&&(t.m=n.m))),t}function v(e,t,n,o,i){return(0,r.pC)(n)&&(t.rings=O(e,n.rings,o,i)),t}function I(e,t,n,o,i){return(0,r.pC)(n)&&(t.paths=x(e,n.paths,o,i)),t}},65341:function(e,t,n){n.d(t,{_W:function(){return h},iV:function(){return m},oj:function(){return T}});n(57658);var r=n(8693),o=n(59053),i=n(5312),s=n(54597),a=n(31957);const c=[0,0];function u(e,t){if(!t)return null;if("x"in t){const n={x:0,y:0};return[n.x,n.y]=e(t.x,t.y,c),null!=t.z&&(n.z=t.z),null!=t.m&&(n.m=t.m),n}if("xmin"in t){const n={xmin:0,ymin:0,xmax:0,ymax:0};return[n.xmin,n.ymin]=e(t.xmin,t.ymin,c),[n.xmax,n.ymax]=e(t.xmax,t.ymax,c),t.hasZ&&(n.zmin=t.zmin,n.zmax=t.zmax,n.hasZ=!0),t.hasM&&(n.mmin=t.mmin,n.mmax=t.mmax,n.hasM=!0),n}return"rings"in t?{rings:l(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:l(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:d(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function l(e,t){const n=[];for(const r of e)n.push(d(r,t));return n}function d(e,t){const n=[];for(const r of e){const e=t(r[0],r[1],[0,0]);n.push(e),r.length>2&&e.push(r[2]),r.length>3&&e.push(r[3])}return n}async function h(e,t){if(!e||!t)return;const n=Array.isArray(e)?e.map((e=>(0,r.pC)(e.geometry)?e.geometry.spatialReference:null)).filter(r.pC):[e];await(0,o.iQ)(n.map((e=>({source:e,dest:t}))))}const f=u.bind(null,a.hG),p=u.bind(null,a.R6);function m(e,t,n,r){if(!e)return e;if(n||(n=t,t=e.spatialReference),!(0,s.JY)(t)||!(0,s.JY)(n)||(0,s.fS)(t,n))return e;if((0,a.Q8)(t,n)){const t=(0,s.sS)(n)?f(e):p(e);return t.spatialReference=n,t}return(0,o.oj)(i.N,[e],t,n,null,r)[0]}class _{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,n){if(!e||!e.length||!t||!n||(0,s.fS)(t,n))return e;const r={geometries:e,inSpatialReference:t,outSpatialReference:n,resolve:null};return this._jobs.push(r),new Promise((e=>{r.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:n,outSpatialReference:r,resolve:c}=e;(0,a.Q8)(n,r)?(0,s.sS)(r)?c(t.map(f)):c(t.map(p)):c((0,o.oj)(i.N,t,n,r,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}const g=new _;function T(e,t,n){return g.push(e,t,n)}},54131:function(e,t,n){n.d(t,{hu:function(){return i},yK:function(){return s}});n(12686),n(97848);var r=n(85381);(0,r.c)();class o{constructor(e){this.message=e}toString(){return`AssertException: ${this.message}`}}function i(e,t){if(!e){t=t||"Assertion";const e=new Error(t).stack;throw new o(`${t} at ${e}`)}}function s(e,t,n,r){let o,i=(n[0]-e[0])/t[0],s=(r[0]-e[0])/t[0];i>s&&(o=i,i=s,s=o);let a=(n[1]-e[1])/t[1],c=(r[1]-e[1])/t[1];if(a>c&&(o=a,a=c,c=o),i>c||a>s)return!1;a>i&&(i=a),c<s&&(s=c);let u=(n[2]-e[2])/t[2],l=(r[2]-e[2])/t[2];return u>l&&(o=u,u=l,l=o),!(i>l||u>s)&&(l<s&&(s=l),!(s<0))}},95055:function(e,t,n){n.r(t),n.d(t,{default:function(){return re}});n(57658);var r=n(61445),o=n(8693),i=n(92454),s=(n(93622),n(94315),n(15055),n(22130),n(81653),n(77623)),a=n(65554),c=n(74674),u=n(16160),l=n(99133),d=n(94872),h=n(73246),f=n(88071),p=n(97257),m=(n(51802),n(97848),n(85381)),_=n(23573);function g(e){return e?{ray:(0,_.Ue)(e.ray),c0:e.c0,c1:e.c1}:{ray:(0,_.Ue)(),c0:0,c1:Number.MAX_VALUE}}new p.x((()=>g()));var T,b;n(59018),n(62069);function x(){return[(0,c.c)(),(0,c.c)(),(0,c.c)(),(0,c.c)(),(0,c.c)(),(0,c.c)(),(0,c.c)(),(0,c.c)()]}function O(e,t){for(let n=0;n<E.NUM;n++){const r=e[n];if(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]>=t[3])return!1}return!0}!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.BOTTOM=2]="BOTTOM",e[e.TOP=3]="TOP",e[e.NEAR=4]="NEAR",e[e.FAR=5]="FAR"}(T||(T={})),function(e){e[e.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",e[e.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",e[e.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",e[e.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",e[e.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",e[e.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",e[e.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",e[e.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(b||(b={}));b.FAR_BOTTOM_RIGHT,b.NEAR_BOTTOM_RIGHT,b.NEAR_BOTTOM_LEFT,b.FAR_BOTTOM_LEFT,b.NEAR_BOTTOM_LEFT,b.NEAR_BOTTOM_RIGHT,b.NEAR_TOP_RIGHT,b.NEAR_TOP_LEFT,b.FAR_BOTTOM_RIGHT,b.FAR_BOTTOM_LEFT,b.FAR_TOP_LEFT,b.FAR_TOP_RIGHT,b.NEAR_BOTTOM_RIGHT,b.FAR_BOTTOM_RIGHT,b.FAR_TOP_RIGHT,b.NEAR_TOP_RIGHT,b.FAR_BOTTOM_LEFT,b.NEAR_BOTTOM_LEFT,b.NEAR_TOP_LEFT,b.FAR_TOP_LEFT,b.FAR_TOP_LEFT,b.NEAR_TOP_LEFT,b.NEAR_TOP_RIGHT,b.FAR_TOP_RIGHT;var E,M;!function(e){e[e.NUM=6]="NUM"}(E||(E={})),function(e){e[e.NUM=8]="NUM"}(M||(M={}));(0,m.f)(-1,-1,-1,1),(0,m.f)(1,-1,-1,1),(0,m.f)(1,1,-1,1),(0,m.f)(-1,1,-1,1),(0,m.f)(-1,-1,1,1),(0,m.f)(1,-1,1,1),(0,m.f)(1,1,1,1),(0,m.f)(-1,1,1,1),new p.x(g),x();var R=n(54131);class y{get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}constructor(e,t){this._objectToBoundingSphere=e,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new N,this._objectCount=0,t&&(void 0!==t.maximumObjectsPerNode&&(this._maximumObjectsPerNode=t.maximumObjectsPerNode),void 0!==t.maximumDepth&&(this._maximumDepth=t.maximumDepth))}destroy(){this._degenerateObjects.clear(),N.clearPool(),L[0]=null,Z.prune(),X.prune()}add(e,t=e.length){this._objectCount+=t,this._grow(e,t);const n=N.acquire();for(let r=0;r<t;r++){const t=e[r];this._isDegenerate(t)?this._degenerateObjects.add(t):(n.init(this._root),this._add(t,n))}N.release(n)}remove(e,t=null){this._objectCount-=e.length;const n=N.acquire();for(const r of e){const e=(0,o.pC)(t)?t:(0,l.h)(this._objectToBoundingSphere(r),q);B(e[3])?(n.init(this._root),this._remove(r,e,n)):this._degenerateObjects.delete(r)}N.release(n),this._shrink()}update(e,t){if(!B(t[3])&&this._isDegenerate(e))return;const n=U(e);this.remove(n,t),this.add(n)}forEachAlongRay(e,t,n){const r=(0,_.re)(e,t);this._forEachNode(this._root,(e=>{if(!this._intersectsNode(r,e))return!1;const t=e.node;return t.terminals.forAll((e=>{this._intersectsObject(r,e)&&n(e)})),null!==t.residents&&t.residents.forAll((e=>{this._intersectsObject(r,e)&&n(e)})),!0}))}forEachAlongRayWithVerticalOffset(e,t,n,r){const o=(0,_.re)(e,t);this._forEachNode(this._root,(e=>{if(!this._intersectsNodeWithOffset(o,e,r))return!1;const t=e.node;return t.terminals.forAll((e=>{this._intersectsObjectWithOffset(o,e,r)&&n(e)})),null!==t.residents&&t.residents.forAll((e=>{this._intersectsObjectWithOffset(o,e,r)&&n(e)})),!0}))}forEach(e){this._forEachNode(this._root,(t=>{const n=t.node;return n.terminals.forAll(e),null!==n.residents&&n.residents.forAll(e),!0})),this._degenerateObjects.forEach(e)}forEachDegenerateObject(e){this._degenerateObjects.forEach(e)}findClosest(e,t,n,r=(()=>!0),o=1/0){let i=1/0,s=1/0,c=null;const u=C(e,t),d=a=>{if(--o,!r(a))return;const u=this._objectToBoundingSphere(a);if(!O(n,u))return;const d=P(e,t,(0,l.g)(u)),h=d-u[3],f=d+u[3];h<i&&(i=h,s=f,c=a)};return this._forEachNodeDepthOrdered(this._root,(r=>{if(o<=0||!O(n,r.bounds))return!1;if((0,a.g)(D,u,r.halfSize),(0,a.a)(D,D,r.bounds),P(e,t,D)>s)return!1;const i=r.node;return i.terminals.forAll((e=>d(e))),null!==i.residents&&i.residents.forAll((e=>d(e))),!0}),e,t),c}forEachInDepthRange(e,t,n,r,o,i,s){let c=-1/0,u=1/0;const d={setRange:e=>{n===y.DepthOrder.FRONT_TO_BACK?(c=Math.max(c,e.near),u=Math.min(u,e.far)):(c=Math.max(c,-e.far),u=Math.min(u,-e.near))}};d.setRange(r);const h=P(t,n,e),f=C(t,n),p=C(t,-n),m=e=>{if(!s(e))return;const r=this._objectToBoundingSphere(e),a=(0,l.g)(r),f=P(t,n,a)-h,p=f-r[3],m=f+r[3];p>u||m<c||!O(i,r)||o(e,d)};this._forEachNodeDepthOrdered(this._root,(e=>{if(!O(i,e.bounds))return!1;if((0,a.g)(D,f,e.halfSize),(0,a.a)(D,D,e.bounds),P(t,n,D)-h>u)return!1;if((0,a.g)(D,p,e.halfSize),(0,a.a)(D,D,e.bounds),P(t,n,D)-h<c)return!1;const r=e.node;return r.terminals.forAll((e=>m(e))),null!==r.residents&&r.residents.forAll((e=>m(e))),!0}),t,n)}forEachNode(e){this._forEachNode(this._root,(t=>e(t.node,t.bounds,t.halfSize)))}forEachNeighbor(e,t){const n=(0,l.a)(t),r=(0,l.g)(t),o=t=>{const o=this._objectToBoundingSphere(t),i=(0,l.a)(o),s=n+i;return!((0,a.d)((0,l.g)(o),r)-s*s<=0)||e(t)};let i=!0;const s=e=>{i&&(i=o(e))};this._forEachNode(this._root,(e=>{const t=(0,l.a)(e.bounds),o=n+t;if((0,a.d)((0,l.g)(e.bounds),r)-o*o>0)return!1;const c=e.node;return c.terminals.forAll(s),i&&null!==c.residents&&c.residents.forAll(s),i})),i&&this.forEachDegenerateObject(s)}_intersectsNode(e,t){return S(t.bounds,2*-t.halfSize,H),S(t.bounds,2*t.halfSize,G),(0,R.yK)(e.origin,e.direction,H,G)}_intersectsNodeWithOffset(e,t,n){return S(t.bounds,2*-t.halfSize,H),S(t.bounds,2*t.halfSize,G),n.applyToMinMax(H,G),(0,R.yK)(e.origin,e.direction,H,G)}_intersectsObject(e,t){const n=this._objectToBoundingSphere(t);return!(n[3]>0)||(0,l.j)(n,e)}_intersectsObjectWithOffset(e,t,n){const r=this._objectToBoundingSphere(t);return!(r[3]>0)||(0,l.j)(n.applyToBoundingSphere(r),e)}_forEachNode(e,t){let n=N.acquire().init(e);const r=[n];for(;0!==r.length;){if(n=r.pop(),t(n)&&!n.isLeaf())for(let e=0;e<n.node.children.length;e++)n.node.children[e]&&r.push(N.acquire().init(n).advance(e));N.release(n)}}_forEachNodeDepthOrdered(e,t,n,r=y.DepthOrder.FRONT_TO_BACK){let o=N.acquire().init(e);const i=[o];for(I(n,r,$);0!==i.length;){if(o=i.pop(),t(o)&&!o.isLeaf())for(let e=7;e>=0;--e){const t=$[e];o.node.children[t]&&i.push(N.acquire().init(o).advance(t))}N.release(o)}}_remove(e,t,n){Z.clear();const r=n.advanceTo(t,((e,t)=>{Z.push(e.node),Z.push(t)}))?n.node.terminals:n.node.residents;if(r.removeUnordered(e),0===r.length)for(let o=Z.length-2;o>=0;o-=2){const e=Z.data[o],t=Z.data[o+1];if(!this._purge(e,t))break}}_nodeIsEmpty(e){if(0!==e.terminals.length)return!1;if(null!==e.residents)return 0===e.residents.length;for(let t=0;t<e.children.length;t++)if(e.children[t])return!1;return!0}_purge(e,t){return t>=0&&(e.children[t]=null),!!this._nodeIsEmpty(e)&&(null===e.residents&&(e.residents=new f.Z({shrink:!0})),!0)}_add(e,t){t.advanceTo(this._objectToBoundingSphere(e))?t.node.terminals.push(e):(t.node.residents.push(e),t.node.residents.length>this._maximumObjectsPerNode&&t.depth<this._maximumDepth&&this._split(t))}_split(e){const t=e.node.residents;e.node.residents=null;for(let n=0;n<t.length;n++){const r=N.acquire().init(e);this._add(t.getItemAt(n),r),N.release(r)}}_grow(e,t){if(0!==t&&(v(e,t,(e=>this._objectToBoundingSphere(e)),V),B(V[3])&&!this._fitsInsideTree(V)))if(this._nodeIsEmpty(this._root.node))(0,l.h)(V,this._root.bounds),this._root.halfSize=1.25*this._root.bounds[3],this._root.updateBoundsRadiusFromHalfSize();else{const e=this._rootBoundsForRootAsSubNode(V);this._placingRootViolatesMaxDepth(e)?this._rebuildTree(V,e):this._growRootAsSubNode(e),N.release(e)}}_rebuildTree(e,t){(0,a.c)(K,t.bounds),K[3]=t.halfSize,v([e,K],2,(e=>e),W);const n=N.acquire().init(this._root);this._root.initFrom(null,W,W[3]),this._root.increaseHalfSize(1.25),this._forEachNode(n,(e=>(this.add(e.node.terminals.data,e.node.terminals.length),null!==e.node.residents&&this.add(e.node.residents.data,e.node.residents.length),!0))),N.release(n)}_placingRootViolatesMaxDepth(e){const t=Math.log(e.halfSize/this._root.halfSize)*Math.LOG2E;let n=0;return this._forEachNode(this._root,(e=>(n=Math.max(n,e.depth),n+t<=this._maximumDepth))),n+t>this._maximumDepth}_rootBoundsForRootAsSubNode(e){const t=e[3],n=e;let r=-1/0;const o=this._root.bounds,i=this._root.halfSize;for(let a=0;a<3;a++){const e=o[a]-i-(n[a]-t),s=n[a]+t-(o[a]+i),c=Math.max(0,Math.ceil(e/(2*i))),u=Math.max(0,Math.ceil(s/(2*i)))+1,l=2**Math.ceil(Math.log(c+u)*Math.LOG2E);r=Math.max(r,l),Y[a].min=c,Y[a].max=u}for(let a=0;a<3;a++){let e=Y[a].min,t=Y[a].max;const n=(r-(e+t))/2;e+=Math.ceil(n),t+=Math.floor(n);const s=o[a]-i-e*i*2;k[a]=s+(t+e)*i}const s=r*i;return k[3]=s*j,N.acquire().initFrom(null,k,s,0)}_growRootAsSubNode(e){const t=this._root.node;(0,a.c)(V,this._root.bounds),V[3]=this._root.halfSize,this._root.init(e),e.advanceTo(V,null,!0),e.node.children=t.children,e.node.residents=t.residents,e.node.terminals=t.terminals}_shrink(){for(;;){const e=this._findShrinkIndex();if(-1===e)break;this._root.advance(e),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let e=null;const t=this._root.node.children;let n=0,r=0;for(;r<t.length&&null==e;)n=r++,e=t[n];for(;r<t.length;)if(t[r++])return-1;return n}_isDegenerate(e){return!B(this._objectToBoundingSphere(e)[3])}_fitsInsideTree(e){const t=this._root.bounds,n=this._root.halfSize;return e[3]<=n&&e[0]>=t[0]-n&&e[0]<=t[0]+n&&e[1]>=t[1]-n&&e[1]<=t[1]+n&&e[2]>=t[2]-n&&e[2]<=t[2]+n}}class N{constructor(){this.bounds=(0,l.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}init(e){return this.initFrom(e.node,e.bounds,e.halfSize,e.depth)}initFrom(e,t,n,r=this.depth){return this.node=(0,o.pC)(e)?e:N.createEmptyNode(),(0,o.pC)(t)&&(0,l.h)(t,this.bounds),this.halfSize=n,this.depth=r,this}increaseHalfSize(e){this.halfSize*=e,this.updateBoundsRadiusFromHalfSize()}updateBoundsRadiusFromHalfSize(){this.bounds[3]=this.halfSize*j}advance(e){let t=this.node.children[e];t||(t=N.createEmptyNode(),this.node.children[e]=t),this.node=t,this.halfSize/=2,this.depth++;const n=w[e];return this.bounds[0]+=n[0]*this.halfSize,this.bounds[1]+=n[1]*this.halfSize,this.bounds[2]+=n[2]*this.halfSize,this.updateBoundsRadiusFromHalfSize(),this}advanceTo(e,t,n=!1){for(;;){if(this.isTerminalFor(e))return t&&t(this,-1),!0;if(this.isLeaf()){if(!n)return t&&t(this,-1),!1;this.node.residents=null}const r=this._childIndex(e);t&&t(this,r),this.advance(r)}}isLeaf(){return null!=this.node.residents}isTerminalFor(e){return e[3]>this.halfSize/2}_childIndex(e){const t=this.bounds;return(t[0]<e[0]?1:0)+(t[1]<e[1]?2:0)+(t[2]<e[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new f.Z({shrink:!0}),residents:new f.Z({shrink:!0})}}static acquire(){return N._pool.acquire()}static release(e){N._pool.release(e)}static clearPool(){N._pool.prune()}}function A(e,t){e[0]=Math.min(e[0],t[0]-t[3]),e[1]=Math.min(e[1],t[1]-t[3]),e[2]=Math.min(e[2],t[2]-t[3])}function F(e,t){e[0]=Math.max(e[0],t[0]+t[3]),e[1]=Math.max(e[1],t[1]+t[3]),e[2]=Math.max(e[2],t[2]+t[3])}function S(e,t,n){n[0]=e[0]+t,n[1]=e[1]+t,n[2]=e[2]+t}function v(e,t,n,r){if(1===t){const t=n(e[0]);(0,l.h)(t,r)}else{H[0]=1/0,H[1]=1/0,H[2]=1/0,G[0]=-1/0,G[1]=-1/0,G[2]=-1/0;for(let r=0;r<t;r++){const t=n(e[r]);B(t[3])&&(A(H,t),F(G,t))}(0,a.h)(r,H,G,.5),r[3]=Math.max(G[0]-H[0],G[1]-H[1],G[2]-H[2])/2}}function I(e,t,n){if(!X.length)for(let r=0;r<8;++r)X.push({index:0,distance:0});for(let r=0;r<8;++r){const n=w[r];X.data[r].index=r,X.data[r].distance=P(e,t,n)}X.sort(((e,t)=>e.distance-t.distance));for(let r=0;r<8;++r)n[r]=X.data[r].index}function C(e,t){let n,r=1/0;for(let o=0;o<8;++o){const i=P(e,t,z[o]);i<r&&(r=i,n=z[o])}return n}function P(e,t,n){return t*(e[0]*n[0]+e[1]*n[1]+e[2]*n[2])}function B(e){return!isNaN(e)&&e!==-1/0&&e!==1/0&&e>0}N._pool=new h.Z(N),function(e){var t;(t=e.DepthOrder||(e.DepthOrder={}))[t.FRONT_TO_BACK=1]="FRONT_TO_BACK",t[t.BACK_TO_FRONT=-1]="BACK_TO_FRONT"}(y||(y={}));const w=[(0,c.f)(-1,-1,-1),(0,c.f)(1,-1,-1),(0,c.f)(-1,1,-1),(0,c.f)(1,1,-1),(0,c.f)(-1,-1,1),(0,c.f)(1,-1,1),(0,c.f)(-1,1,1),(0,c.f)(1,1,1)],z=[(0,c.f)(-1,-1,-1),(0,c.f)(-1,-1,1),(0,c.f)(-1,1,-1),(0,c.f)(-1,1,1),(0,c.f)(1,-1,-1),(0,c.f)(1,-1,1),(0,c.f)(1,1,-1),(0,c.f)(1,1,1)],j=Math.sqrt(3),L=[null];function U(e){return L[0]=e,L}const k=(0,l.c)(),D=(0,c.c)(),H=(0,c.c)(),G=(0,c.c)(),Z=new f.Z,q=(0,l.c)(),V=(0,l.c)(),K=(0,l.c)(),W=(0,l.c)(),Y=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],X=new f.Z,$=[0,0,0,0,0,0,0,0],J=y;var Q=n(6234);const ee=1e3;function te(e,t,n){const r=(0,l.c)(),o=(0,l.g)(r);return(0,a.z)(o,o,e,.5),(0,a.z)(o,o,t,.5),r[3]=(0,a.i)(o,e),(0,a.a)(o,o,n),r}let ne=class{constructor(){this._idToComponent=new Map,this._components=new J((e=>e.bounds)),this._edges=new J((e=>e.bounds)),this._tmpLineSegment=(0,u.Ue)(),this._tmpP1=(0,c.c)(),this._tmpP2=(0,c.c)(),this._tmpP3=(0,c.c)(),this.remoteClient=null}async fetchCandidates(e,t){await Promise.resolve(),(0,i.k_)(t),await this._ensureEdgeLocations(e,t);const n=[];return this._edges.forEachNeighbor((t=>(this._addCandidates(e,t,n),n.length<ee)),e.bounds),{result:{candidates:n}}}async _ensureEdgeLocations(e,t){const n=[];if(this._components.forEachNeighbor((e=>{if((0,o.Wi)(e.info)){const{id:t,uid:r}=e;n.push({id:t,uid:r})}return!0}),e.bounds),!n.length)return;const r={components:n},i=await this.remoteClient.invoke("fetchAllEdgeLocations",r,(0,o.Pt)(t,{}));for(const o of i.components)this._setFetchEdgeLocations(o)}async add(e){const t=new oe(e.id,e.bounds);return this._idToComponent.set(t.id,t),this._components.add([t]),{result:{}}}async remove(e){const t=this._idToComponent.get(e.id);if(t){const e=[];this._edges.forEachNeighbor((n=>(n.component===t&&e.push(n),!0)),t.bounds),this._edges.remove(e),this._components.remove([t]),this._idToComponent.delete(t.id)}return{result:{}}}_setFetchEdgeLocations(e){const t=this._idToComponent.get(e.id);if((0,o.Wi)(t)||e.uid!==t.uid)return;const n=Q.n_.createView(e.locations),r=new Array(n.count),i=(0,c.c)(),s=(0,c.c)();for(let o=0;o<n.count;o++){n.position0.getVec(o,i),n.position1.getVec(o,s);const a=te(i,s,e.origin),c=new ie(t,o,a);r[o]=c}this._edges.add(r);const{objectIds:a,origin:u}=e;t.info={locations:n,objectIds:a,origin:u}}_addCandidates(e,t,n){const{info:r}=t.component,{origin:o,objectIds:i}=r,s=r.locations,c=s.position0.getVec(t.index,this._tmpP1),u=s.position1.getVec(t.index,this._tmpP2);(0,a.a)(c,c,o),(0,a.a)(u,u,o);const l=i[s.componentIndex.get(t.index)];this._addEdgeCandidate(e,l,c,u,n),this._addVertexCandidate(e,l,c,n),this._addVertexCandidate(e,l,u,n)}_addEdgeCandidate(e,t,n,r,o){if(!(e.types&d.r.EDGE))return;const i=(0,l.g)(e.bounds),s=(0,u.zk)(n,r,this._tmpLineSegment),h=(0,u.nF)(s,i,this._tmpP3);(0,l.m)(e.bounds,h)&&o.push({type:"edge",objectId:t,target:(0,c.a)(h),distance:(0,a.i)(i,h),start:(0,c.a)(n),end:(0,c.a)(r)})}_addVertexCandidate(e,t,n,r){if(!(e.types&d.r.VERTEX))return;const o=(0,l.g)(e.bounds);(0,l.m)(e.bounds,n)&&r.push({type:"vertex",objectId:t,target:(0,c.a)(n),distance:(0,a.i)(o,n)})}};ne=(0,r._)([(0,s.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],ne);const re=ne;class oe{constructor(e,t){this.id=e,this.bounds=t,this.info=null,this.uid=++oe.uid}}oe.uid=0;class ie{constructor(e,t,n){this.component=e,this.index=t,this.bounds=n}}}}]);