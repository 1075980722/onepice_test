"use strict";(self["webpackChunkonepic"]=self["webpackChunkonepic"]||[]).push([[8087],{18087:function(e,t,p){p.r(t),p.d(t,{default:function(){return n}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"riverinfo"},[t("Videodialog",{ref:"videodoalog",staticClass:"videodialog"}),t("Popuptemplate",{directives:[{name:"show",rawName:"v-show",value:e.popupshow,expression:"popupshow"}],ref:"popup",staticClass:"popup",style:e.popupStyle,attrs:{popupshow:e.popupshow,dataArr:e.dataArr},on:{handelclose:function(t){return e.handelclose()}}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.currTip,expression:"currTip"}],staticClass:"map-point-tip",style:e.currTipStyle},[e._v(" "+e._s(e.currTip)+" ")]),e._l(e.popupList,(function(p){return t("div",{key:p.id,staticClass:"popup-tip",style:p.popuptipStyle},[t("span",[e._v(e._s(p.name))])])}))],2)},i=[],o=(p(57658),{components:{Videodialog:()=>p.e(625).then(p.bind(p,50625)),Popuptemplate:()=>p.e(2061).then(p.bind(p,42061))},data(){return{popupshow:!1,popupStyle:{},currTip:"",currTipStyle:{},dataArr:[],popupList:[],popuptipStyle:{}}},mounted(){this.initBind()},methods:{initBind(){this.$store.state.map.view.on("pointer-down",(e=>{const{x:t,y:p}=e;this.$store.state.map.view.hitTest(e).then((async e=>{const s=e.results;if(1==s.length&&"point"==s[0].graphic.geometry.type&&"hedaoLayer"===s[0].layer.id){this.popupshow=!0,t>200&&t<1720&&p<520?setTimeout((()=>{this.$refs.popup.$el.classList.add("popup--aligned-bottom-center"),this.$refs.popup.$el.classList.remove("popup--aligned-top-center"),this.$refs.popup.$el.classList.remove("popup--aligned-top-left"),this.$refs.popup.$el.classList.remove("popup--aligned-top-right"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-left"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-right"),this.popupStyle={top:p+30+"px",left:t+-210+"px"}}),10):t>200&&t<1720&&p>520?setTimeout((()=>{let e=this.$refs.popup.$el.offsetHeight;this.$refs.popup.$el.classList.add("popup--aligned-top-center"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-center"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-left"),this.$refs.popup.$el.classList.remove("popup--aligned-top-left"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-right"),this.$refs.popup.$el.classList.remove("popup--aligned-top-right"),this.popupStyle={top:p+-e+-30+"px",left:t+-210+"px"}}),10):t>1720&&p<520?setTimeout((()=>{this.$refs.popup.$el.classList.add("popup--aligned-bottom-left"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-center"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-right"),this.$refs.popup.$el.classList.remove("popup--aligned-top-right"),this.$refs.popup.$el.classList.remove("popup--aligned-top-center"),this.$refs.popup.$el.classList.remove("popup--aligned-top-left"),this.popupStyle={top:p+30+"px",left:t+-410+"px"}}),10):t>1720&&p>520?setTimeout((()=>{this.$refs.popup.$el.classList.add("popup--aligned-top-left"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-center"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-right"),this.$refs.popup.$el.classList.remove("popup--aligned-top-right"),this.$refs.popup.$el.classList.remove("popup--aligned-top-center"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-left");let e=this.$refs.popup.$el.offsetHeight;this.popupStyle={top:p+-e+-20+"px",left:t+-410+"px"}}),10):t<200&&p<520?setTimeout((()=>{this.$refs.popup.$el.classList.add("popup--aligned-bottom-right"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-center"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-left"),this.$refs.popup.$el.classList.remove("popup--aligned-top-right"),this.$refs.popup.$el.classList.remove("popup--aligned-top-center"),this.$refs.popup.$el.classList.remove("popup--aligned-top-left"),this.popupStyle={top:p+30+"px",left:t+10+"px"}}),10):t<200&&p>520&&setTimeout((()=>{this.$refs.popup.$el.classList.add("popup--aligned-top-right"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-center"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-right"),this.$refs.popup.$el.classList.remove("popup--aligned-bottom-left"),this.$refs.popup.$el.classList.remove("popup--aligned-top-center"),this.$refs.popup.$el.classList.remove("popup--aligned-top-left");let e=this.$refs.popup.$el.offsetHeight;this.popupStyle={top:p+-e+-20+"px",left:t+10+"px"}}),10);const{sourceLayer:e,attributes:i}=s[0].graphic;if(!e||!i)return;const{stationType:o}=i;this.getDeviceData(o,i)}}))})),this.$store.state.map.view.on("pointer-move",(e=>{const{x:t,y:p}=e;this.$store.state.map.view.hitTest(e).then((e=>{const s=e.results;if(s.length&&s[0].graphic){const{sourceLayer:e,attributes:i}=s[0].graphic;if(!e||!i)return;const{location:o,positionDescription:a}=i;e&&["hedaoLayer"].includes(e.id)?(o?this.currTip=`${o}`:a&&(this.currTip=`${a}`),this.currTipStyle={top:p+-25+"px",left:t+15+"px"}):this.currTip=""}else this.currTip=""}))})),this.$store.state.map.view.whenLayerView(this.$store.state.map.identLayer).then((()=>{this.$store.state.map.identLayer.queryFeatures().then((e=>{e.features.forEach(((e,t)=>{let p={type:"point",x:parseFloat(e.geometry.longitude),y:parseFloat(e.geometry.latitude)},s=this.$store.state.map.view.toScreen(p),i={id:t,name:"123",popuptipStyle:{top:s.y+-24940+"px",left:s.x+87100+"px"}};this.popupList.push(i)}))}))}))},getDeviceData(e,t){let p=e.split(",");if(p.includes("80")){let{signsCode:e,location:p,longitude:s,latitude:i,image:o}=t,a=[];a.push({signsCode:e},{location:p},{longitude:s},{latitude:i}),this.dataArr=[],a.forEach((e=>{let t={},p=Object.values(e).join();switch(Object.keys(e).join()){case"signsCode":t.nm="编号";break;case"location":t.nm="公示牌位置";break;case"longitude":t.nm="经度";break;case"latitude":t.nm="纬度";break}t.data=""===p?"—":p,t.url=o,this.dataArr.push(t)}))}else if(p.includes("90")){let{riverName:e,administrativeDistrict:p,positionDescription:s,longitude:i,latitude:o,specification:a,frequencyOrFlowOfBlowdown:r,type:l,riverLevel:n,pipeBottomElevation:u,managementUnit:c,photo:h}=t,d=[];d.push({riverName:e},{administrativeDistrict:p},{longitude:i},{latitude:o},{specification:a},{frequencyOrFlowOfBlowdown:r},{type:l},{riverLevel:n},{pipeBottomElevation:u},{managementUnit:c},{positionDescription:s}),this.dataArr=[],d.forEach((e=>{let t={},p=Object.values(e).join();switch(Object.keys(e).join()){case"riverName":t.nm="河道名称";break;case"administrativeDistrict":t.nm="行政区属";break;case"longitude":t.nm="经度";break;case"latitude":t.nm="维度";break;case"specification":t.nm="规格";break;case"frequencyOrFlowOfBlowdown":t.nm="排污频率活流量";break;case"type":t.nm="类型";break;case"riverLevel":t.nm="排查时河道水位";break;case"pipeBottomElevation":t.nm="管底高程";break;case"managementUnit":t.nm="管理单位";break;case"positionDescription":t.nm="位置";break}t.data=""===p?"":p,t.url=h,this.dataArr.push(t)}))}},handelclose(){this.popupshow=!1}}}),a=o,r=p(1001),l=(0,r.Z)(a,s,i,!1,null,"30ceab78",null),n=l.exports}}]);