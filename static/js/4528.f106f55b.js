"use strict";(self["webpackChunkonepic"]=self["webpackChunkonepic"]||[]).push([[4528],{34528:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"popupchart"},[e("div",{staticClass:"top"},[e("span",[t._v("时间:")]),e("el-select",{attrs:{placeholder:"请选择"},on:{change:t.handleChangeData},model:{value:t.optionTime,callback:function(e){t.optionTime=e},expression:"optionTime"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"center"},[e("div",{ref:"shuiqing",staticStyle:{width:"600px",height:"360px"}})]),e("div",{staticClass:"footer"},[e("p",[t._v("备注:"+t._s(t.remark))])])])},s=[],n=(a(57658),a(11117)),l=a(76174),o={name:"popupchart",props:{chartData:{type:Object},query:{type:Object}},data(){return{mychart:"",option:{},remark:"",options:[{value:"6",label:"6小时"},{value:"12",label:"12小时"},{value:"24",label:"一天"},{value:"48",label:"二天"},{value:"72",label:"三天"}],optionTime:"24",chartDatatemp:[],code:this.query.code,type:this.query.type}},watch:{chartData:{handler(t){this.$nextTick((()=>{this.chartDatatemp=t,""!=this.mychart&&(this.mychart.clear(this.option),this.initChart())}))},deep:!0,immediate:!0}},created(){this.$store.watch((t=>t.point.isBindYul),(()=>{this.$nextTick((()=>{window.addEventListener("resize",(function(){this.mychart.resize()})),""!=this.mychart&&(this.mychart.clear(this.option),this.initChart())}))}))},mounted(){this.$nextTick((()=>{this.mychart=n.S1(this.$refs.shuiqing)})),this.initChart()},methods:{initChart(){this.mychart=n.S1(this.$refs.shuiqing),this.option={grid:[{x:"7%",y:"12%",height:"25%",left:"10%",right:"10%"},{x2:"7%",y2:"7%",height:"35%",left:"10%",right:"10%",bottom:"15%"}],legend:{data:["雨量","累计雨量","水位"]},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},axisPointer:{triggerTooltip:!0,link:{xAxisIndex:"all"}},xAxis:[{show:!0,type:"category",boundaryGap:!0,gridIndex:0,axisTick:{alignWithLabel:!1},axisLine:{lineStyle:{color:"#ccc"}},splitLine:{show:!0,interval:0,lineStyle:{shadowColor:"#CCCCCC"}},axisLabel:{show:!1},data:this.chartDatatemp.xData},{show:!0,type:"category",boundaryGap:!0,gridIndex:1,axisTick:{inside:!0,alignWithLabel:!0},axisLine:{lineStyle:{color:"#ccc"}},axisLabel:{color:"#A1A2A3"},splitLine:{show:!0,interval:0,lineStyle:{shadowColor:"#CCCCCC",shadowOffsetY:-80}},splitArea:{show:!1},data:this.chartDatatemp.xData}],yAxis:[{show:!0,type:"value",gridIndex:1,nameLocation:"middle",name:"水位",nameTextStyle:{padding:15},position:"left",axisLine:{lineStyle:{show:!0}},splitNumber:5,axisTick:{inside:!0,show:!0},splitLine:{show:!0},axisLabel:{show:!0,formatter:"{value}",textStyle:{fontSize:12}},min:0,max:5},{type:"value",gridIndex:0,show:!0,inverse:!0,name:"雨量",nameTextStyle:{padding:15},position:"left",nameLocation:"middle",axisLine:{lineStyle:{}},axisTick:{inside:!0,show:!0},axisLabel:{show:!0,formatter:"{value}",textStyle:{fontSize:12}},splitNumber:5,min:0,max:5},{type:"value",gridIndex:0,show:!0,inverse:!0,name:"累计雨量",nameTextStyle:{padding:15},position:"right",nameLocation:"middle",axisLine:{lineStyle:{}},axisTick:{inside:!0,show:!0},axisLabel:{show:!0,formatter:"{value}",textStyle:{fontSize:12}},splitNumber:5,min:0,max:5}],series:[{name:"雨量",type:"bar",barGap:"10%",barCategoryGap:"10%",xAxisIndex:0,itemStyle:{normal:{show:!0,color:"#286dcf",barBorderRadius:5}},barMaxWidth:10,yAxisIndex:2,data:this.chartDatatemp.yData3},{name:"累计雨量",type:"line",itemStyle:{normal:{color:"#037FB2",barBorderRadius:5}},barWidth:10,yAxisIndex:2,data:this.chartDatatemp.yData2},{name:"水位",type:"line",itemStyle:{normal:{barBorderRadius:5,color:"#037FB2"}},barWidth:10,xAxisIndex:1,yAxisIndex:0,data:this.chartDatatemp.yData1}]},this.mychart.setOption(this.option),this.$nextTick((()=>{window.addEventListener("resize",(function(){this.mychart.resize()}))}))},handleChangeData(t){this.handleData(t)},async handleData(t){const e=this.formatDateTime(new Date(new Date((new Date).getTime()-60*t*60*1e3))),a=this.formatDateTime(new Date((new Date).getTime()));let i={startTime:e,endTime:a,code:this.code,type:this.type},s=await(0,l._2)(i),n=s.result;this.$store.state.point.tableData=[],this.chartData={xData:[],yData1:[],yData2:[],yData3:[]};let o=[];if(null!=n.shuiQingHisInfoVo.shuiQingDataVoList){let t=n.shuiQingHisInfoVo.shuiQingDataVoList.filter((t=>"00"===t.collectTime.slice(-5,-3)));t.forEach(((t,e)=>{let a={};a.id=e+1,a.collectTime=null==t.collectTime?"-":t.collectTime,a.shuiWei=null==t.shuiWei?"-":t.shuiWei,this.chartData.xData.push(t.collectTime),this.chartData.yData1.push(t.shuiWei),o.push(a)}))}let h=[];null!=n.yuLiangInfoVo.yuLiangAccumulateVos&&n.yuLiangInfoVo.yuLiangAccumulateVos.forEach((t=>{let e={};e.yul=null==t.hsum?"—":t.hsum,h.push(e),this.chartData.yData2.push(t.cum),this.chartData.yData3.push(t.hsum)}));let r=[];o.forEach((t=>{r.push(Object.assign(t,h[t.id-1]))})),r.forEach((t=>{this.$store.dispatch("updateTableData",t)}))}}},h=o,r=a(1001),c=(0,r.Z)(h,i,s,!1,null,"28cc7150",null),d=c.exports}}]);